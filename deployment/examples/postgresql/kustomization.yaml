apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# PostgreSQL Example (HA Mode)
#
# This example shows how to configure maas-api with an external PostgreSQL database.
# This mode supports HPA (multiple replicas) for high availability.
#
# Prerequisites:
#   1. Deploy PostgreSQL using an operator or managed service:
#      - OpenShift: Install CloudNativePG from OperatorHub (certified-operators)
#      - Kubernetes: See https://cloudnative-pg.io/documentation/current/quickstart/
#      - Or use a managed service (RDS, Cloud SQL, etc.)
#
#   2. Create the database secret (use secret_example.yaml as a template):
#      cp deployment/examples/postgresql/secret_example.yaml my-secret.yaml
#      # Edit my-secret.yaml with your actual DATABASE_URL
#      kubectl apply -f my-secret.yaml -n maas-api
#
#   3. Deploy:
#      kustomize build deployment/examples/postgresql | kubectl apply -f -

namespace: maas-api

resources:
  - ../../base/maas-api

patches:
  - path: database-env-patch.yaml
